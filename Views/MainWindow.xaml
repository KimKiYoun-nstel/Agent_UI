<Window x:Class="Agent.UI.Wpf.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Agent Console (WPF)" Height="760" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top: Connection + Config -->
        <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,8">
            <TextBlock Text="Role" VerticalAlignment="Center"/>
            <ComboBox Width="110" ItemsSource="{Binding Roles}" SelectedItem="{Binding SelectedRole}"/>
            <TextBlock Text="Address" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBox Width="160" Text="{Binding Address}"/>
            <TextBlock Text="Port" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBox Width="80" Text="{Binding Port}"/>
            <Button Content="Connect" Command="{Binding ConnectCommand}"/>
            <Button Content="Disconnect" Command="{Binding DisconnectCommand}"/>

            <TextBlock Text="Config" Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBox Width="360" IsReadOnly="True" Text="{Binding ConfigRoot}"/>
            <Button Content="Browse" Command="{Binding BrowseConfigCommand}"/>
            <Button Content="Reload" Command="{Binding ReloadConfigCommand}"/>
        </DockPanel>

        <!-- Center: two columns -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left: DDS + Topic + Payload -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <GroupBox Header="DDS Entities" Grid.Row="0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Domain" VerticalAlignment="Center"/>
                        <TextBox Width="60" Text="{Binding DomainId}"/>
                        <TextBlock Text="QoS" Margin="12,0,0,0" VerticalAlignment="Center"/>
                        <ComboBox Width="220" ItemsSource="{Binding QosProfiles}" SelectedItem="{Binding SelectedQosProfile}"/>
                        <Button Content="Create Participant" Command="{Binding CreateParticipantCommand}"/>
                        <Button Content="Clear" Command="{Binding ClearDdsCommand}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Topic / Type" Grid.Row="1">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Topic" VerticalAlignment="Center"/>
                        <TextBox Width="210" Text="{Binding Topic}"/>
                        <TextBlock Text="Type" Margin="12,0,0,0" VerticalAlignment="Center"/>
                        <ComboBox Width="260" ItemsSource="{Binding TypeNames}" SelectedItem="{Binding SelectedType}"/>
                        <Button Content="Open Form" Command="{Binding OpenFormCommand}"/>
                        <Button Content="Sample JSON" Command="{Binding FillSampleCommand}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Payload" Grid.Row="2">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBox Grid.Row="0" Text="{Binding Payload, UpdateSourceTrigger=PropertyChanged}" 
                     FontFamily="Consolas" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Create Writer" Command="{Binding CreateWriterCommand}" Click="Button_Click_1"/>
                            <Button Content="Create Reader" Command="{Binding CreateReaderCommand}" Click="Button_Click_2"/>
                            <Button Content="Publish" Command="{Binding PublishCommand}" Click="Button_Click_3"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>
            </Grid>

            <!-- Right: Log -->
            <GroupBox Header="Log" Grid.Column="1" Margin="8,0,0,0">
                <DockPanel>
                    <ComboBox DockPanel.Dock="Top" Width="140" ItemsSource="{Binding LogLevels}" SelectedItem="{Binding SelectedLogLevel}" />
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding Logs}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" FontFamily="Consolas" TextWrapping="Wrap"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,0">
                        <Button Content="Clear" Command="{Binding ClearLogCommand}"/>
                    </StackPanel>
                </DockPanel>
            </GroupBox>
        </Grid>

        <!-- Bottom: Status -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Text="{Binding Status}" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
