완전 이해. 너가 받은 **MVVM 뼈대**를 기준으로, 말한 UI 요구를 “코드로만” 넣는 튜토리얼로 정리했어.
(어디 파일, 어디에 붙이는지까지 콕 집어줌)

---

# 0) 목표 요약

1. **DDS Entities** 안에 **publisher/subscriber 입력 + 생성/삭제 버튼** 추가
2. **로그와 분리된 “메시지 패널(보낸/받은 JSON)”** 추가
3. **Log Clear 버튼**을 우상단의 작은 버튼으로
4. **전체 간격/정렬 깔끔**하게 (라벨/필드 여백 통일)

---

# 1) 스타일 정리(간격/정렬 통일)

## 파일: `Theme/Styles.xaml` (기존 파일에 **아래 블록 추가**)

```xml
<!-- 공통 라벨/필드/스몰 버튼 -->
<Style x:Key="LabelText" TargetType="TextBlock">
  <Setter Property="VerticalAlignment" Value="Center"/>
  <Setter Property="Margin" Value="0,0,8,0"/>
</Style>

<Style x:Key="FieldControl" TargetType="Control">
  <Setter Property="Margin" Value="0,0,12,0"/>
  <Setter Property="VerticalAlignment" Value="Center"/>
</Style>

<Style x:Key="SmallButton" TargetType="Button">
  <Setter Property="Padding" Value="6,3"/>
  <Setter Property="Margin" Value="6,0,0,0"/>
</Style>

<!-- 모든 TextBox/ComboBox에 기본 간격 적용 -->
<Style TargetType="TextBox" BasedOn="{StaticResource FieldControl}"/>
<Style TargetType="ComboBox" BasedOn="{StaticResource FieldControl}"/>
```

> 효과: 라벨/필드 간격이 전역으로 통일됨. 버튼도 적당한 크기.

---

# 2) DDS Entities에 Pub/Sub 입력/버튼 추가

## 파일: `Views/MainWindow.xaml`

**`<GroupBox Header="DDS Entities"> ... </GroupBox>` 블록을 아래 내용으로 교체**

```xml
<GroupBox Header="DDS Entities" Grid.Row="0">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>  <!-- participant -->
      <RowDefinition Height="Auto"/>  <!-- publisher/subscriber -->
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="80"/>   <!-- label -->
      <ColumnDefinition Width="160"/>  <!-- field -->
      <ColumnDefinition Width="80"/>
      <ColumnDefinition Width="220"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- participant 라인 -->
    <TextBlock Grid.Row="0" Grid.Column="0" Text="Domain" Style="{StaticResource LabelText}"/>
    <TextBox   Grid.Row="0" Grid.Column="1" Text="{Binding DomainId}" />
    <TextBlock Grid.Row="0" Grid.Column="2" Text="QoS" Style="{StaticResource LabelText}"/>
    <ComboBox  Grid.Row="0" Grid.Column="3" ItemsSource="{Binding QosProfiles}" SelectedItem="{Binding SelectedQosProfile}"/>
    <StackPanel Grid.Row="0" Grid.Column="4" Orientation="Horizontal" HorizontalAlignment="Right">
      <Button Content="Create Participant" Command="{Binding CreateParticipantCommand}" />
      <Button Content="Clear" Command="{Binding ClearDdsCommand}" />
    </StackPanel>

    <!-- publisher/subscriber 라인 -->
    <TextBlock Grid.Row="1" Grid.Column="0" Text="Publisher" Style="{StaticResource LabelText}"/>
    <TextBox   Grid.Row="1" Grid.Column="1" Text="{Binding PublisherName}" />
    <StackPanel Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="1" Orientation="Horizontal">
      <Button Content="Create" Command="{Binding CreatePublisherCommand}" />
      <Button Content="Destroy" Command="{Binding DestroyPublisherCommand}" Style="{StaticResource SmallButton}"/>
    </StackPanel>

    <TextBlock Grid.Row="1" Grid.Column="3" Text="Subscriber" Style="{StaticResource LabelText}" Margin="24,0,8,0"/>
    <StackPanel Grid.Row="1" Grid.Column="4" Orientation="Horizontal">
      <TextBox Width="180" Text="{Binding SubscriberName}" />
      <Button Content="Create" Command="{Binding CreateSubscriberCommand}" />
      <Button Content="Destroy" Command="{Binding DestroySubscriberCommand}" Style="{StaticResource SmallButton}"/>
    </StackPanel>
  </Grid>
</GroupBox>
```

## 파일: `ViewModels/MainViewModel.cs`

**속성과 커맨드 추가**

```csharp
// --- Pub/Sub 이름 ---
private string _publisherName = "pub1";
public string PublisherName { get => _publisherName; set => SetField(ref _publisherName, value); }

private string _subscriberName = "sub1";
public string SubscriberName { get => _subscriberName; set => SetField(ref _subscriberName, value); }

// --- Commands (필드 선언) ---
public RelayCommand CreatePublisherCommand { get; }
public RelayCommand DestroyPublisherCommand { get; }
public RelayCommand CreateSubscriberCommand { get; }
public RelayCommand DestroySubscriberCommand { get; }
```

**생성자에서 와이어링**

```csharp
CreatePublisherCommand = new RelayCommand(() =>
{
    Log($"[Publisher] create: name={PublisherName}, domain={DomainId}, qos={SelectedQosProfile}");
    // TODO: IPC - op=create, target=publisher
});
DestroyPublisherCommand = new RelayCommand(() => Log($"[Publisher] destroy: name={PublisherName}"));

CreateSubscriberCommand = new RelayCommand(() =>
{
    Log($"[Subscriber] create: name={SubscriberName}, domain={DomainId}, qos={SelectedQosProfile}");
    // TODO: IPC - op=create, target=subscriber
});
DestroySubscriberCommand = new RelayCommand(() => Log($"[Subscriber] destroy: name={SubscriberName}"));
```

---

# 3) “메시지 패널(보낸/받은 JSON)” 추가

오른쪽 컬럼을 **탭**으로 나눠서 `Log` 와 `Messages` 를 번갈아 보게 하자.
(요청한 “로그와 별개 패널”을 화면 낭비 없이 구현하기 좋음)

## 파일: `Views/MainWindow.xaml`

**오른쪽 GroupBox 전체를 `TabControl`로 교체**

기존:

```xml
<GroupBox Header="Log" Grid.Column="1" ...> ... </GroupBox>
```

교체:

```xml
<TabControl Grid.Column="1" Margin="8,0,0,0">
  <!-- Log 탭 -->
  <TabItem Header="Log">
    <DockPanel>
      <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,6">
        <ComboBox Width="140" ItemsSource="{Binding LogLevels}" SelectedItem="{Binding SelectedLogLevel}" />
        <Button Content="Clear" Command="{Binding ClearLogCommand}" Style="{StaticResource SmallButton}"/>
      </StackPanel>
      <ScrollViewer VerticalScrollBarVisibility="Auto">
        <ItemsControl ItemsSource="{Binding Logs}">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <TextBlock Text="{Binding}" FontFamily="Consolas" TextWrapping="Wrap"/>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>
    </DockPanel>
  </TabItem>

  <!-- Messages 탭 -->
  <TabItem Header="Messages">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>

      <!-- 상단 필터/초기화 -->
      <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Right" Margin="0,0,0,6">
        <Button Content="Clear" Command="{Binding ClearTrafficCommand}" Style="{StaticResource SmallButton}"/>
      </StackPanel>

      <!-- 실제 메시지 리스트 -->
      <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
        <ItemsControl ItemsSource="{Binding Traffic}">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border BorderBrush="#DDD" BorderThickness="1" CornerRadius="4" Padding="6" Margin="0,0,0,6">
                <StackPanel>
                  <TextBlock FontFamily="Consolas" FontWeight="Bold"
                             Text="{Binding Header}" />
                  <TextBox FontFamily="Consolas" Text="{Binding Json}"
                           IsReadOnly="True" TextWrapping="Wrap"
                           Background="#FFF" BorderThickness="0" />
                </StackPanel>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>
    </Grid>
  </TabItem>
</TabControl>
```

## 파일: `ViewModels/MainViewModel.cs`

**메시지 모델/컬렉션/커맨드 추가**

```csharp
// 메시지 항목
public sealed class TrafficItem
{
    public required string Header { get; init; }  // [HH:mm:ss] OUT topic=... / IN topic=...
    public required string Json { get; init; }    // 실제 전송/수신 JSON
}

public ObservableCollection<TrafficItem> Traffic { get; } = new();
public RelayCommand ClearTrafficCommand { get; }
```

**생성자에서 초기화 + 예제 로깅 연결**

```csharp
ClearTrafficCommand = new RelayCommand(() => Traffic.Clear());

// 예: 기존 PublishCommand에서 로그만 찍던 것을 메시지 기록까지 남김
PublishCommand = new RelayCommand(() =>
{
    Log($"Publish to '{Topic}' payload bytes={Payload.Length}");
    Traffic.Add(new TrafficItem
    {
        Header = $"[{_clock.Now():HH:mm:ss}] OUT topic='{Topic}' type='{SelectedType}'",
        Json = Payload
    });
});
```

> 나중에 IPC 받기/보내기 붙일 때,
>
> * 보내기: `OUT`로 Traffic에 추가
> * 수신: 게이트웨이 응답 payload를 `IN`으로 Traffic에 추가
>   이 패턴 그대로 쓰면 된다.

---

# 4) 기존 Log Clear 버튼 위치·크기 조정

위 **탭 구조**에서 이미 우상단 작은 버튼으로 반영했어.
(로그 탭 상단 StackPanel에 `SmallButton` 스타일 적용)

---

# 5) 정렬/여백 결과

* 1번에서 추가한 `Styles.xaml` 덕에 **라벨/필드/버튼 간격**이 통일.
* DDS Entities는 **Grid 5열**로 배치해 라벨-필드 정렬이 맞아떨어짐.
* 오른쪽 패널은 **탭 전환**으로 공간 낭비 없이 “로그/메시지”를 분리.

---

## 적용 순서 요약

1. `Theme/Styles.xaml`에 스타일 블록 추가
2. `Views/MainWindow.xaml`의 **DDS Entities** 교체
3. 같은 파일에서 오른쪽 **Log 영역→TabControl** 교체
4. `ViewModels/MainViewModel.cs`에 **Pub/Sub 속성+커맨드** 추가
5. 같은 파일에 **TrafficItem/Traffic/ClearTrafficCommand** 추가 + `PublishCommand`에 예시 연동

---

원하면 위 변경을 **패치 적용한 새 템플릿**으로 바로 뽑아줄 수도 있어.
일단 직접 반영해보고, 스샷 주면 간격/정렬 더 다듬어줄게.
